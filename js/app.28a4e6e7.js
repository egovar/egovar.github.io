(function(){var e={6867:function(e,t,n){"use strict";var o=n(144),r=n(998),s=n(6843),a=n(3059),l=function(){var e=this,t=e._self._c,n=e._self._setupProxy;return t(r.Z,{staticClass:"app"},[t(s.Z,{attrs:{app:"",color:"primary","clipped-right":"",dark:""}}),t(a.Z,{staticClass:"main"},[t(n.BlocksTable)],1)],1)},i=[],c=n(2765),u=function(){var e=this,t=e._self._c,n=e._self._setupProxy;return t(c.Z,{staticClass:"table__container"},[t(n.BasicBlocksTable,{ref:"table",staticClass:"table",attrs:{items:n.blocks,loading:n.loading,options:n.options,"disable-sort":n.loading,"server-items-length":n.total,"item-class":n.getBlockRowClass,height:"calc(100vh - 4rem)"},on:{"update:options":function(e){n.options=e}}}),t(n.NewBlocksDrawer,{staticClass:"table__new-blocks-table",attrs:{"new-blocks":n.newBlocks}})],1)},f=[],v=(n(7658),n(129)),p=n.n(v);const d=n(3485),_="https://api.mumbainet.tzkt.io/v1/ws",m={connection:(new d.HubConnectionBuilder).withUrl(_).build(),init:async function(){await this.connection.start(),this.connection.onclose(this.init)},send:function(e){return this.connection.invoke(e)},on:function(e,t){this.connection.on(e,t)}},h="https://api.mumbainet.tzkt.io",w={_transformToQuery:e=>e&&"object"===typeof e?`?${p().stringify(e,{allowDots:!0})}`:"",_readResponse:async e=>{try{return await e.json()}catch(t){console.error(`RESPONSE PARSING ERROR: ${t}`)}},_logError:e=>{console.error(`FETCH ERROR: ${e}`)},async get(e,t){try{const n=await fetch(`${h}${e}${this._transformToQuery(t)}`);if(n.ok)return await this._readResponse(n);this._logError(n.status)}catch(n){this._logError(n)}}};function b({sortBy:e,sortDesc:t}={sortBy:M,sortDesc:V}){return{sort:{[t?"desc":"asc"]:e}}}function y({newRow:e,comparisonRow:t,sortBy:n,sortDesc:o}){const r=e[n],s=t[n];return o?r>s||r===s&&e[S]>t[S]:r<s||r===s&&e[S]<t[S]}function k(e){return`${e.slice(0,$)}...`}function R(e){return`${e.slice(0,H)}...${e.slice(-P)}`}function O(e){const{level:t,timestamp:n,hash:o,proposer:r,reward:s,fees:a}=e;return{level:t,timestamp:n,hash:o,proposer:r,reward:s,fees:a}}function g(e){const{allBlocks:t}=e,n=t.slice(-1)[0],o=t[0];return y({...e,comparisonRow:o})?0:y({...e,comparisonRow:n})?r({start:0,end:t.length-1}):-1;function r({start:n,end:o}){let s=n,a=o;const l=n+Math.round((o-n)/2);return y({...e,comparisonRow:t[l]})?a=l:s=l,a-s===1?a:r({start:s,end:a})}}const B="https://mumbainet.tzkt.io/",E="https://services.tzkt.io/v1/avatars/",$=10,T=1e6,H=8,P=5,[S,D,L,A,C,x]=["level","timestamp","hash","proposer","reward","fees"],I=[S,D,L,A,C,x],Z=I.join(","),N=40,j=0,M=S,V=!0,F={select:{fields:Z},limit:N,offset:j},K=b(),z=8,U=[S,C,x],W=I.map((e=>({text:e[0].toUpperCase()+e.slice(1),value:e,sortable:U.includes(e)}))),Q="SubscribeToBlocks",q="blocks",G=100,J=-N,X=z+2;function Y(e=K){return w.get("/v1/blocks",{...F,...e})}var ee=n(3423),te=n(5409),ne=n(5495),oe=function(){var e=this,t=e._self._c,n=e._self._setupProxy;return t(te.Z,{attrs:{headers:n.COLUMNS,items:e.$attrs.items,loading:e.$attrs.loading,options:e.$attrs.options,"disable-sort":e.$attrs["disable-sort"],"server-items-length":e.$attrs["server-items-length"],"item-class":e.$attrs["item-class"],"hide-default-footer":"","fixed-header":"",height:e.$attrs.height,"item-key":n.LEVEL},on:{"update:options":[function(t){return e.$set(e.$attrs,"options",t)},function(t){return e.$emit("update:options",t)}]},scopedSlots:e._u([{key:`item.${n.LEVEL}`,fn:function({item:o}){return[t("a",{attrs:{href:`${n.ROOT_LINK}${o[n.LEVEL]}`}},[e._v(e._s(o[n.LEVEL]))])]}},{key:`item.${n.HASH}`,fn:function({item:o}){return[t("a",{attrs:{href:`${n.ROOT_LINK}${o[n.HASH]}`}},[e._v(e._s(n.formatHash(o[n.HASH])))])]}},{key:`item.${n.PROPOSER}`,fn:function({item:o}){return[o[n.PROPOSER]?[t(ee.Z,{staticClass:"mr-3"},[t(ne.Z,{attrs:{src:`${n.AVATAR_ROOT_LINK}${o[n.PROPOSER].address}`}})],1),t("a",{attrs:{href:`${n.ROOT_LINK}${o[n.PROPOSER].address}`}},[e._v(" "+e._s(n.formatProposer(o[n.PROPOSER].address))+" ")])]:e._e()]}},{key:`item.${n.REWARD}`,fn:function({item:t}){return[e._v(" "+e._s(t[n.REWARD]/n.MICRO_DIVIDER)+" ꜩ ")]}},{key:`item.${n.FEES}`,fn:function({item:t}){return[e._v(" "+e._s(t[n.FEES]/n.MICRO_DIVIDER)+" ꜩ ")]}}],null,!0)})},re=[],se={__name:"BasicBlocksTable",emits:["update:options"],setup(e){return{__sfc:!0,COLUMNS:W,LEVEL:S,HASH:L,REWARD:C,FEES:x,ROOT_LINK:B,MICRO_DIVIDER:T,PROPOSER:A,AVATAR_ROOT_LINK:E,formatHash:k,formatProposer:R}}},ae=se,le=n(1001),ie=(0,le.Z)(ae,oe,re,!1,null,"8b6dd350",null),ce=ie.exports,ue=n(2604),fe=function(){var e=this,t=e._self._c,n=e._self._setupProxy;return t("div",{staticClass:"new-blocks-drawer"},[t("button",{on:{click:function(e){n.drawer=!0}}},[e._v("Open")]),t(ue.Z,{attrs:{app:"",temporary:"",right:"",width:"700"},model:{value:n.drawer,callback:function(e){n.drawer=e},expression:"drawer"}},[t(n.BasicBlocksTable,{attrs:{items:e.newBlocks}})],1)],1)},ve=[],pe={__name:"NewBlocksDrawer",props:{newBlocks:{type:Array,default:()=>[]}},setup(e){const t=(0,o.iH)(!0);return{__sfc:!0,drawer:t,BasicBlocksTable:ce}}},de=pe,_e=(0,le.Z)(de,fe,ve,!1,null,"c23b79a0",null),me=_e.exports,he={__name:"BlocksTable",setup(e){const t=(0,o.iH)(!0),n=(0,o.iH)([]),r=1,s=(0,o.iH)({}),a=(0,o.iH)({}),l=(0,o.iH)(-1),i=(0,o.iH)(0);Y().then((e=>{e&&Array.isArray(e)&&(n.value=e,s.value=e[0],R(e[0].timestamp),a.value=e.slice(-1)[0],i.value+=N)})).finally((()=>t.value=!1));const c=(0,o.iH)([]),u=(0,o.iH)(0);function f({type:e,state:t,data:o}){function r(e){e.forEach((e=>{const t=O(e),o=g({newRow:t,allBlocks:n.value,sortBy:p.value,sortDesc:d.value});-1!==o&&(u.value++,t.new=!0,n.value=[...n.value.slice(0,o),t,...n.value.slice(o)])}))}function s(e){e.forEach((e=>{const t=O(e);let n=!1;y({newRow:t,comparisonRow:a.value,sortBy:p.value,sortDesc:d.value})&&(u.value++,n=!0),c.value.push({...t,new:!0,isHigherInMainTable:n})}))}0===e?l.value=t:1===e&&o&&Array.isArray(o)&&(n.value.length<2.5*N?r(o):s(o),k.value=z)}function v(e){return e.new?(t(e),"green lighten-4 table__row"):"table__row";function t(e){setTimeout((()=>{e.new=!1}),1e3*X)}}m.init().then((()=>{m.send(Q),m.on(q,(e=>{f(e)}))}));const p=(0,o.iH)(M),d=(0,o.iH)(V),_=(0,o.Fl)({get:()=>({sortBy:[p.value],sortDesc:[d.value],itemsPerPage:-1,mustSort:!0}),set:async({sortBy:e,sortDesc:o})=>{const r=e[0],s=o[0];r===p.value&&s===d.value||(r!==p.value?(p.value=r,d.value=V):d.value=s,c.value=[],t.value=!0,n.value=await Y(b({sortBy:p.value,sortDesc:d.value})),R(n.value[0].timestamp),i.value=j,u.value=0,w.value.scrollTop=0,t.value=!1)}}),h=(0,o.iH)(null),w=(0,o.iH)(null);(0,o.bv)((()=>{async function e(){if(t.value)return;t.value=!0;const e=await Y({...b({sortBy:p.value,sortDesc:d.value}),offset:i.value+u.value}),r=o(e);i.value+=N,n.value=[...n.value,...r],t.value=!1}function o(e){const t=n.value.slice(J),o=e.filter((e=>!t.some((({level:t})=>t===e.level))));return o}w.value=h.value.$el.querySelector(".v-data-table__wrapper"),w.value.addEventListener("scroll",(()=>{w.value.scrollHeight-w.value.clientHeight-w.value.scrollTop<=G&&e()}))}));const k=(0,o.iH)(null);function R(e){k.value=z-Math.round((Date.now()-new Date(e).getTime())/1e3)}return{__sfc:!0,loading:t,blocks:n,total:r,topLocalBlock:s,bottomLocalBlock:a,topRemoteBlockLevel:l,mainOffset:i,newBlocks:c,additionalOffset:u,newBlockHandler:f,getBlockRowClass:v,sortBy:p,sortDesc:d,options:_,table:h,scrollableTable:w,secondsToNextBlock:k,setSecondsToNextBlock:R,BasicBlocksTable:ce,NewBlocksDrawer:me}}},we=he,be=(0,le.Z)(we,u,f,!1,null,"9fdadc8a",null),ye=be.exports,ke={__name:"App",setup(e){return{__sfc:!0,BlocksTable:ye}}},Re=ke,Oe=(0,le.Z)(Re,l,i,!1,null,"fed9eaf4",null),ge=Oe.exports,Be=n(1705);o.ZP.use(Be.Z);var Ee=new Be.Z({});o.ZP.config.productionTip=!1,new o.ZP({vuetify:Ee,render:e=>e(ge)}).$mount("#app")},4654:function(){}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var s=t[o]={exports:{}};return e[o](s,s.exports,n),s.exports}n.m=e,function(){var e=[];n.O=function(t,o,r,s){if(!o){var a=1/0;for(u=0;u<e.length;u++){o=e[u][0],r=e[u][1],s=e[u][2];for(var l=!0,i=0;i<o.length;i++)(!1&s||a>=s)&&Object.keys(n.O).every((function(e){return n.O[e](o[i])}))?o.splice(i--,1):(l=!1,s<a&&(a=s));if(l){e.splice(u--,1);var c=r();void 0!==c&&(t=c)}}return t}s=s||0;for(var u=e.length;u>0&&e[u-1][2]>s;u--)e[u]=e[u-1];e[u]=[o,r,s]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var r,s,a=o[0],l=o[1],i=o[2],c=0;if(a.some((function(t){return 0!==e[t]}))){for(r in l)n.o(l,r)&&(n.m[r]=l[r]);if(i)var u=i(n)}for(t&&t(o);c<a.length;c++)s=a[c],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return n.O(u)},o=self["webpackChunkbaking_test"]=self["webpackChunkbaking_test"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(6867)}));o=n.O(o)})();
//# sourceMappingURL=app.28a4e6e7.js.map