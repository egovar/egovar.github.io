(function(){var e={3300:function(e,t,n){"use strict";var o=n(144),s=n(998),l=n(6843),r=n(3059),a=function(){var e=this,t=e._self._c,n=e._self._setupProxy;return t(s.Z,{staticClass:"app"},[t(l.Z,{attrs:{app:"",color:"primary","clipped-right":""}},[t(n.NewBlockTimer,{ref:"timer",attrs:{"new-blocks-count":n.newBlocks.length},on:{"open:new-blocks-table":function(e){return n.toggleNewBlocksTable(!0)}}})],1),t(r.Z,{staticClass:"main"},[t(n.BlocksTable,{ref:"mainTable",on:{"update:timer":n.updateTimer}})],1),t(n.NewBlocksDrawer,{staticClass:"table__new-blocks-table",attrs:{value:n.drawer,"new-blocks":n.newBlocks},on:{"toggle:new-blocks-table":n.toggleNewBlocksTable}})],1)},i=[],c=n(2118),u=function(){var e=this,t=e._self._c,n=e._self._setupProxy;return t("div",[t(c.Z,{staticClass:"table__container py-0"},[t(n.BasicBlocksTable,{ref:"table",staticClass:"table",attrs:{items:n.blocks,loading:n.loading,options:n.options,"disable-sort":n.loading,"server-items-length":1,"item-class":n.getBlockRowClass,height:"calc(100vh - 4rem)"},on:{"update:options":function(e){n.options=e}}})],1)],1)},f=[],v=(n(7658),n(129)),p=n.n(v);const m=n(3485),d="https://api.mumbainet.tzkt.io/v1/ws",_={connection:(new m.HubConnectionBuilder).withUrl(d).build(),init:async function(){await this.connection.start(),this.connection.onclose(this.init)},send:function(e){return this.connection.invoke(e)},on:function(e,t){this.connection.on(e,t)}};function w({sortBy:e,sortDesc:t}={sortBy:F,sortDesc:M}){return{sort:{[t?"desc":"asc"]:e}}}function b({newRow:e,comparisonRow:t,sortBy:n,sortDesc:o}){const s=e[n],l=t[n];return o?s>l||s===l&&e[C]>t[C]:s<l||s===l&&e[C]<t[C]}function h(e){return`${e.slice(0,T)}...`}function k(e){return`${e.slice(0,P)}...${e.slice(-$)}`}function g(e){const{level:t,timestamp:n,hash:o,proposer:s,reward:l,fees:r}=e;return{level:t,timestamp:n,hash:o,proposer:s,reward:l,fees:r}}function y(e){const{allBlocks:t}=e,n=t.slice(-1)[0],o=t[0];return b({...e,comparisonRow:o})?0:b({...e,comparisonRow:n})?s({start:0,end:t.length-1}):-1;function s({start:n,end:o}){let l=n,r=o;const a=n+Math.round((o-n)/2);return b({...e,comparisonRow:t[a]})?r=a:l=a,r-l===1?r:s({start:l,end:r})}}const B="https://mumbainet.tzkt.io/",R="https://services.tzkt.io/v1/avatars/",T=10,O=1e6,E=1e3,H=100,P=8,$=5,[C,S,L,D,x,N]=["level","timestamp","hash","proposer","reward","fees"],Z=[C,S,L,D,x,N],A=Z.join(","),I=40,j=0,F=C,M=!0,V={select:{fields:A},limit:I,offset:j},K=w(),z=8,U=[C,x,N],W=Z.map((e=>({text:e[0].toUpperCase()+e.slice(1),value:e,sortable:U.includes(e)}))),Q="SubscribeToBlocks",q="blocks",G=100,Y=-I,J=z+2;function X(e=K){return te.get("/v1/blocks",{...V,...e})}const ee="https://api.mumbainet.tzkt.io",te={_transformToQuery:e=>e&&"object"===typeof e?`?${p().stringify(e,{allowDots:!0})}`:"",_readResponse:async e=>{try{return await e.json()}catch(t){console.error(`RESPONSE PARSING ERROR: ${t}`)}},_logError:e=>{console.error(`FETCH ERROR: ${e}`)},async get(e,t){try{const n=await fetch(`${ee}${e}${this._transformToQuery(t)}`);if(n.ok)return await this._readResponse(n);this._logError(n.status)}catch(n){this._logError(n)}}};var ne=n(3423),oe=n(5863),se=n(5495),le=function(){var e=this,t=e._self._c,n=e._self._setupProxy;return t(oe.Z,{attrs:{headers:n.COLUMNS,items:e.$attrs.items,loading:e.$attrs.loading,options:e.$attrs.options,"disable-sort":e.$attrs["disable-sort"],"server-items-length":e.$attrs["server-items-length"],"item-class":e.$attrs["item-class"],"hide-default-footer":"","fixed-header":"",height:e.$attrs.height,"item-key":n.LEVEL},on:{"update:options":[function(t){return e.$set(e.$attrs,"options",t)},function(e){return n.emit("update:options",e)}]},scopedSlots:e._u([{key:`item.${n.LEVEL}`,fn:function({item:o}){return[t("a",{attrs:{href:`${n.ROOT_LINK}${o[n.LEVEL]}`}},[e._v(e._s(o[n.LEVEL]))])]}},{key:`item.${n.HASH}`,fn:function({item:o}){return[t("a",{attrs:{href:`${n.ROOT_LINK}${o[n.HASH]}`}},[e._v(e._s(n.formatHash(o[n.HASH])))])]}},{key:`item.${n.PROPOSER}`,fn:function({item:o}){return[o[n.PROPOSER]?[t(ne.Z,{staticClass:"mr-3"},[t(se.Z,{attrs:{src:`${n.AVATAR_ROOT_LINK}${o[n.PROPOSER].address}`}})],1),t("a",{attrs:{href:`${n.ROOT_LINK}${o[n.PROPOSER].address}`}},[e._v(" "+e._s(n.formatProposer(o[n.PROPOSER].address))+" ")])]:e._e()]}},{key:`item.${n.REWARD}`,fn:function({item:t}){return[e._v(" "+e._s(t[n.REWARD]/n.MICRO_DIVIDER)+" ꜩ ")]}},{key:`item.${n.FEES}`,fn:function({item:t}){return[e._v(" "+e._s(t[n.FEES]/n.MICRO_DIVIDER)+" ꜩ ")]}}],null,!0)})},re=[],ae={__name:"BasicBlocksTable",emits:["update:options"],setup(e,{emit:t}){return{__sfc:!0,emit:t,COLUMNS:W,LEVEL:C,HASH:L,REWARD:x,FEES:N,ROOT_LINK:B,MICRO_DIVIDER:O,PROPOSER:D,AVATAR_ROOT_LINK:R,formatHash:h,formatProposer:k}}},ie=ae,ce=n(1001),ue=(0,ce.Z)(ie,le,re,!1,null,"bb903792",null),fe=ue.exports,ve={__name:"BlocksTable",emits:["update:timer"],setup(e,{expose:t,emit:n}){const s=(0,o.iH)(!0),l=(0,o.iH)([]),r=(0,o.iH)({}),a=(0,o.iH)(0);X().then((e=>{e&&Array.isArray(e)&&(l.value=e,v.value=e[0][C],T(O(e[0].timestamp)),r.value=e.slice(-1)[0],a.value+=I)})).finally((()=>s.value=!1));const i=(0,o.iH)([]);t({newBlocks:i});const c=(0,o.iH)(0);function u({type:e,state:t,data:n},o=!0){function s(e){e.forEach((e=>{const t=g(e),n=y({newRow:t,allBlocks:l.value,sortBy:d.value,sortDesc:h.value});-1!==n&&(c.value++,t.new=!0,l.value=[...l.value.slice(0,n),t,...l.value.slice(n)])}))}function a(e){e.forEach((e=>{const t=g(e);b({newRow:t,comparisonRow:r.value,sortBy:d.value,sortDesc:h.value})&&c.value++,i.value.push({...t,new:!0})}))}0===e?p.value=t:1===e&&n&&Array.isArray(n)&&(l.value.length<2.5*I?s(n):a(n),o&&T(z))}function f(e){return e.new?(t(e),"green lighten-4 table__row"):"table__row";function t(e){setTimeout((()=>{e.new=!1}),J*E)}}_.init().then((()=>{_.send(Q),_.on(q,(e=>{u(e)}))}));const v=(0,o.iH)(null),p=(0,o.iH)(null),m=(0,o.iH)(!1);(0,o.YP)([v,p],(async([e,t])=>{if(!m.value&&e&&t&&t>e){m.value=!0;const n=await X({...K,level:{gt:e,le:t}});u({type:1,data:n},!1)}}));const d=(0,o.iH)(F),h=(0,o.iH)(M),k=(0,o.Fl)({get:()=>({sortBy:[d.value],sortDesc:[h.value],itemsPerPage:-1,mustSort:!0}),set:async({sortBy:e,sortDesc:t})=>{const n=e[0],o=t[0];n===d.value&&o===h.value||(n!==d.value?(d.value=n,h.value=M):h.value=o,i.value=[],s.value=!0,l.value=await X(w({sortBy:d.value,sortDesc:h.value})),T(O(l.value[0].timestamp)),a.value=j,c.value=0,R.value.scrollTop=0,s.value=!1)}}),B=(0,o.iH)(null),R=(0,o.iH)(null);function T(e){n("update:timer",e)}function O(e){return z-Math.round((Date.now()-new Date(e).getTime())/E)}return(0,o.bv)((()=>{async function e(){if(s.value)return;s.value=!0;const e=await X({...w({sortBy:d.value,sortDesc:h.value}),offset:a.value+c.value}),n=t(e);r.value=n.slice(-1)[0],a.value+=I,l.value=[...l.value,...n],s.value=!1}function t(e){const t=l.value.slice(Y),n=e.filter((e=>!t.some((({level:t})=>t===e.level))));return n}R.value=B.value.$el.querySelector(".v-data-table__wrapper"),R.value.addEventListener("scroll",(()=>{R.value.scrollHeight-R.value.clientHeight-R.value.scrollTop<=G&&e()}))})),{__sfc:!0,loading:s,blocks:l,bottomLocalBlock:r,mainOffset:a,newBlocks:i,additionalOffset:c,newBlockHandler:u,getBlockRowClass:f,topLocalBlockLevel:v,topRemoteBlockLevel:p,lostFetched:m,sortBy:d,sortDesc:h,options:k,table:B,scrollableTable:R,emit:n,setSecondsToNextBlock:T,getSecondsToNextBlock:O,BasicBlocksTable:fe}}},pe=ve,me=(0,ce.Z)(pe,u,f,!1,null,"2fabc48b",null),de=me.exports,_e=n(9582),we=n(4886),be=n(3305),he=n(1713),ke=n(3687),ge=function(){var e=this,t=e._self._c,n=e._self._setupProxy;return t(c.Z,{staticClass:"py-0"},[t(he.Z,{attrs:{dense:""}},[t(ke.Z),t(_e.Z,{staticClass:"col-2",on:{click:n.onClickTimer}},[t(we.ZB,{staticClass:"d-flex pa-1 justify-space-between align-center"},[t("div",{staticClass:"timer__text"},[t("p",{staticClass:"ma-0"},[e._v(e._s(n.newBlockText)+" "+e._s(n.secondsLeft)+"s")]),e.newBlocksCount>0?t("p",{staticClass:"ma-0 text-decoration-underline font-weight-light caption"},[e._v(" Open new blocks ("+e._s(e.newBlocksCount)+") ")]):e._e()]),t(be.Z,{staticClass:"timer__progress-circle",attrs:{value:n.percentLeft,color:"primary"}})],1)],1)],1)],1)},ye=[],Be={__name:"NewBlockTimer",props:{newBlocksCount:{type:Number,default:0}},emits:["open:new-blocks-table"],setup(e,{expose:t,emit:n}){const s=e;function l(){s.newBlocksCount>0&&n("open:new-blocks-table")}function r(e){clearInterval(i.value),a.value=e*E,i.value=setInterval((()=>{a.value-=c}),c)}t({setTimer:r});const a=(0,o.iH)(null),i=(0,o.iH)(null),c=z*E/H,u=(0,o.Fl)((()=>{const e=Math.ceil(a.value/E);return a.value>=0?e:-e})),f=(0,o.Fl)((()=>a.value>0?a.value/c:0)),v=(0,o.Fl)((()=>a.value>=-1*E?"New block in":"New block is late for"));return{__sfc:!0,props:s,onClickTimer:l,emit:n,setTimer:r,milliSecondsLeft:a,interval:i,delta:c,secondsLeft:u,percentLeft:f,newBlockText:v}}},Re=Be,Te=(0,ce.Z)(Re,ge,ye,!1,null,"e1095706",null),Oe=Te.exports,Ee=n(2604),He=function(){var e=this,t=e._self._c,n=e._self._setupProxy;return t(Ee.Z,{attrs:{value:e.value,app:"",temporary:"",right:"",width:"900"},on:{input:function(e){return n.emit("toggle:new-blocks-table",e)}}},[t(n.BasicBlocksTable,{attrs:{items:e.newBlocks,options:n.options,height:"100%"}})],1)},Pe=[],$e={__name:"NewBlocksDrawer",props:{value:{type:Boolean,default:!1},newBlocks:{type:Array,default:()=>[]}},emits:["toggle:new-blocks-table"],setup(e,{emit:t}){const n=e,o={sortBy:[F],sortDesc:[M],itemsPerPage:-1};return{__sfc:!0,props:n,emit:t,options:o,BasicBlocksTable:fe}}},Ce=$e,Se=(0,ce.Z)(Ce,He,Pe,!1,null,"928a6e08",null),Le=Se.exports,De={__name:"App",setup(e){const t=(0,o.iH)(!1);(0,o.bv)((()=>{t.value=!0}));const n=(0,o.iH)(null);function s(e){t.value&&n.value.setTimer(e)}const l=(0,o.iH)(!1);function r(e=!l.value){l.value=e}const a=(0,o.iH)(null),i=(0,o.Fl)((()=>t.value?a.value.newBlocks:[]));return{__sfc:!0,mounted:t,timer:n,updateTimer:s,drawer:l,toggleNewBlocksTable:r,mainTable:a,newBlocks:i,BlocksTable:de,NewBlockTimer:Oe,NewBlocksDrawer:Le}}},xe=De,Ne=(0,ce.Z)(xe,a,i,!1,null,"2cfcabfe",null),Ze=Ne.exports,Ae=n(1705);o.ZP.use(Ae.Z);var Ie=new Ae.Z({});o.ZP.config.productionTip=!1,new o.ZP({vuetify:Ie,render:e=>e(Ze)}).$mount("#app")},4654:function(){}},t={};function n(o){var s=t[o];if(void 0!==s)return s.exports;var l=t[o]={exports:{}};return e[o](l,l.exports,n),l.exports}n.m=e,function(){var e=[];n.O=function(t,o,s,l){if(!o){var r=1/0;for(u=0;u<e.length;u++){o=e[u][0],s=e[u][1],l=e[u][2];for(var a=!0,i=0;i<o.length;i++)(!1&l||r>=l)&&Object.keys(n.O).every((function(e){return n.O[e](o[i])}))?o.splice(i--,1):(a=!1,l<r&&(r=l));if(a){e.splice(u--,1);var c=s();void 0!==c&&(t=c)}}return t}l=l||0;for(var u=e.length;u>0&&e[u-1][2]>l;u--)e[u]=e[u-1];e[u]=[o,s,l]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var s,l,r=o[0],a=o[1],i=o[2],c=0;if(r.some((function(t){return 0!==e[t]}))){for(s in a)n.o(a,s)&&(n.m[s]=a[s]);if(i)var u=i(n)}for(t&&t(o);c<r.length;c++)l=r[c],n.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return n.O(u)},o=self["webpackChunkbaking_test"]=self["webpackChunkbaking_test"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(3300)}));o=n.O(o)})();
//# sourceMappingURL=app.ef85d7be.js.map